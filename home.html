<!DOCTYPE html>
<html>
<head> 
<title> Dhaka bus Route </title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<!--	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/skeleton/2.0.4/skeleton.min.css">-->
<link rel="stylesheet" href="design.css">

<script type="text/javascript" src="query.js"></script>
<script type="text/javascript" src= "myscript.js" >
</script>
</head>
<body>
<div class="modal">
	<div class="modal-inner">
		<div class="modal-content">
<!--			<div class="modal-close-icon">-->
<!--				<a href="javascript:void(0)" class="close-modal"><i class="fa fa-times" aria-hidden="true"></i></a>-->
<!--			</div>-->
			<div class="modal-content-inner">

				<ul class="busRoutes">
					<li>Start</li>
					<li>Station</li>
					<li>Station</li>
					<li>End</li>
				</ul>
				<div class="routeHome">

				</div>
			</div>
			<hr class="modal-buttons-seperator">
			<div class="modal-buttons">
				<button class="button close-modal">Close</button>
			</div>
		</div>
	</div>
</div>

<!--	<main class="container demo-container">-->
<!--		<br>-->
<!--		<button class="">Launch modal window</button>-->
<!--	</main>-->
<div class="split left">
<!--	<iframe src="https://www.google.com/maps/embed?pb=!1m28!1m12!1m3!1d29212.895494355333!2d90.35914680117119!3d23.761213991306782!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!4m13!3e0!4m5!1s0x3755c0f596a1ef75%3A0x1c386acb29c34356!2sGabtoli%2C%20Bangladesh!3m2!1d23.783725699999998!2d90.34424489999999!4m5!1s0x3755b888ad339cb5%3A0x20c70986185ad2ba!2sMogbazar%2C%20Dhaka%2C%20Bangladesh!3m2!1d23.749357099999997!2d90.4089838!5e0!3m2!1sen!2sca!4v1586150284216!5m2!1sen!2sca" width="100%" height="250" frameborder="0" style="border:0;" allowfullscreen="" aria-hidden="false" tabindex="0"></iframe>-->
  <div class="centered">

	  <span style="font-size:20px;cursor:pointer;display: block;margin: 10px" onclick="openNav()">&#9776; Menu</span>
	  <form id="searchBusForm">
    <input class="inputOne" type="text" id="myInput"  placeholder="Enter Source" size="50" required list="locations">

	<input class="inputTwo" type="text" id="myInput2"  placeholder="Enter Destination" size="50" required list="locations">

		  <datalist id="locations">

		  </datalist>
		<div id="mySidenav" class="sidenav">
		<a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
		<a href="#">About</a>
		<a href="#">Services</a>
		<a href="#">Clients</a>
		<a href="#">Contact</a>
		</div>

	  <input id="searchBtn" type="submit" value="Search" style="color: white">
	  </form>
  </div>

</div>
<!-- Right side html-->

<div class="split right ">



  <div class="centereTop">
    <h2 id="sourceTODestination">Source - Destination</h2>
  </div>
		
<div class="textBox" id="searchResult">
	<table >
		<thead >
		<tr><td>Bus Name</td>
			<td>First Station</td>
			<td>Last Station</td>
			<td>Bust Type</td>
			<td>Action</td></tr>
		</thead>
		<tbody id="outputTable">


		</tbody>

	</table>
</div>
  <div class="navbar">
  <a href="#home" id="floatLeft" class="active" >Home</a>
  <a href="busList.html" class="floatRight" >All Bus</a>
	  <a href="addBuses.html" class="floatRight" >Add Bus</a>
</div>

<div class="main">
</div>
</div>


<script>
function openNav() {
  document.getElementById("mySidenav").style.width = "250px";
}

function closeNav() {
  document.getElementById("mySidenav").style.width = "0";
}
</script>


<script src="main.js"></script>
<script>
	var options='';
	if(busList.length>0){
		for (let i=0;i<AllLocations.length;i++){
			options +=`<option>${AllLocations[i]}</option>`;
			document.getElementById('locations').innerHTML=options;
		}
	}

	if(busList.length>0){showSearchResult(busList);
		modalFunc();
	}

	const searchBusForm=document.getElementById('searchBusForm');
	const sourceTODestination=document.getElementById('sourceTODestination')

	searchBusForm.addEventListener('submit',function (e) {
		e.preventDefault();

		let foundBuses=searchBus();
		if (foundBuses.length>0){
			showSearchResult(foundBuses);
			modalFunc();
			// modalFunc();
		}else{
			outputTable.style.textAlign='center';
			outputTable.innerHTML=`<p id="notFound">Sorry! No buses found.</p>`;
			setTimeout(function () {
			document.getElementById('notFound').style.display='none';
			showSearchResult(busList);
			modalFunc()
			sourceTODestination.innerText=`Source - Destination`;
				// modalFunc();
			},7000)
		}
		searchBusForm.reset();

	})

	outputTable.addEventListener('click',function (e) {
		e.preventDefault();
		let id=e.target.nextElementSibling.innerText;
		if(e.target.className=='seeRoute button open-modal'){
			console.log(id);
			showRouteHome(id);
		}
	})

	function showRouteHome(busId) {
		let list=document.querySelector('.busRoutes');
		list.innerHTML='';
		currentBus=busList.filter(function (bus) {
			return bus.id==busId
		});
		currentBus[0].stationArray.forEach(function (station) {
			let li= document.createElement('li');
			li.appendChild(document.createTextNode(station));
			list.appendChild(li);
		});


	}
function modalFunc() {


	var modal = document.querySelector('.modal');
	var closeButtons = document.querySelector('.close-modal');


	// set open modal behaviour
	btns=document.querySelectorAll('.open-modal');

	function toggler() {

		modal.classList.toggle('modal-open');
		console.log('777')
	}

	btns.forEach(function (btn) {

		btn.addEventListener('click',toggler);
	})
	// set close modal behaviour



	closeButtons.addEventListener('click',function () {
		toggler();
		document.location.reload();
	});




	// close modal if clicked outside content area

	document.querySelector('.modal-inner').addEventListener('click', toggler);
	// prevent modal inner from closing parent when clicked
	document.querySelector('.modal-content').addEventListener('click', function(e) {
		e.stopPropagation();

	});

}






</script>

</body>
</html>
